<!DOCTYPE HTML>
<html lang="en">

<head>
  <title>Atlas</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
  <style>
    .section {
      display: grid;
      grid-template-columns: repeat(auto-fill, 16rem);
      justify-content: space-around;
      gap: 1rem;
    }

    .section .card {
      width: 16rem;
      height: 14rem;
    }

    h2 {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 1em;
    }

    h2:before,
    h2:after {
      content: "";
      border-top: 1px solid black;
      align-self: center;
    }

    article {
      margin: 1rem 0;
    }

    .disabled {
      opacity: 0.5;
    }

  </style>
</head>

<body>

  <nav class="navbar navbar-dark bg-primary">
    <div class="container-fluid">
      <div>
        <a class="navbar-brand" href="./">Atlas</a>
        <a class="navbar-brand" href="javascript:void(0)" id="project-name" ></a>
      </span>
    </div>
  </nav>

  <main class="container">

    <article>
      <h2>Specification Editor</h2>
      <div class="section">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="https://demo.dataspecer.com/specification?dataSpecificationIri=$data-specification-iri$&returnUrlName=Atlas&returnUrl=$return-url$" class="tool-link">Edit
                specification</a>
            </h5>
            <p class="card-text">
              Create or modify data structures that can be used to generate various artifacts.
            </p>
          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="https://demo.dataspecer.com/specification/generate?dataSpecificationIri=$data-specification-iri$&returnUrlName=Atlas&returnUrl=$return-url$" class="tool-link">Generate artifacts</a>
            </h5>
            <p class="card-text">
              Generate .ZIP file containing various artifacts from the data structures.
              The generation process can be highly configured.
            </p>
          </div>
        </div>

      </div>
    </article>

    <article>
      <h2>Data Publisher</h2>
      <div class="section">

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href=" http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/databases" class="tool-link">Database</a>
            </h5>
            <p class="card-text">Administrator of underlying database systems.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/schema-category" class="tool-link">Data Modelling</a>
            </h5>
            <p class="card-text">Modelling structure and integrity constraints in multi-model data.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/schema-category?pimIri=$data-specification-iri$" class="tool-link">Import Schema</a>
            </h5>
            <p class="card-text">Import an existing schema.</p>
          </div>
        </div>

        <div class="card disabled">
          <div class="card-body">
            <h5 class="card-title">
              <span>Schema Inference</span>
            </h5>
            <p class="card-text">Extraction of implicit schema from data.</p>
            <p class="fw-bold">Integration in progress.</p>
            <a href="https://www.ksi.mff.cuni.cz/~koupil/mm-infer/index.html" class="btn btn-secondary">See the stand alone tool</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/logical-models" class="tool-link">Schema Decomposition</a>
            </h5>
            <p class="card-text">Decomposition and mapping of multi-model schema to underlying logical models.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/jobs" class="tool-link">Data Migration</a>
            </h5>
            <p class="card-text">Changes the logical representation of data, or imports/exports data.</p>
          </div>
        </div>

      </div>
    </article>

    <article>
      <h2>Data Consumer</h2>
      <div class="section">

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href=" http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/databases" class="tool-link">Database</a>
            </h5>
            <p class="card-text">Administrator of underlying database systems.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/data-sources" class="tool-link">Data Source</a>
            </h5>
            <p class="card-text">Administration of external data sources.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/schema-category" class="tool-link">Data Modelling</a>
            </h5>
            <p class="card-text">Modelling structure and integrity constraints in multi-model data.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/schema-category?pimIri=$data-specification-iri$" class="tool-link">Import Schema</a>
            </h5>
            <p class="card-text">Import an existing schema.</p>
          </div>
        </div>

        <div class="card disabled">
          <div class="card-body">
            <h5 class="card-title">
              <span>Schema Inference</span>
            </h5>
            <p class="card-text">Extraction of implicit schema from data.</p>
            <p class="fw-bold">Integration in progress.</p>
            <a href="https://www.ksi.mff.cuni.cz/~koupil/mm-infer/index.html" class="btn btn-secondary">See the stand alone tool</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/logical-models" class="tool-link">Schema Decomposition</a>
            </h5>
            <p class="card-text">Decomposition and mapping of multi-model schema to underlying logical models.</p>
          </div>
        </div>

        <div class="card disabled">
          <div class="card-body">
            <h5 class="card-title">
              <span>Evolution Management</span>
            </h5>
            <p class="card-text">Managing structural changes in data reflecting changes in user requirements.</p>
            <p class="fw-bold">Work in progress.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <a href="http://nosql.ms.mff.cuni.cz/mmcat/$project-id$/jobs" class="tool-link">Data Migration</a>
            </h5>
            <p class="card-text">Changes the logical representation of data, or imports/exports data.</p>
          </div>
        </div>

        <div class="card disabled">
          <div class="card-body">
            <h5 class="card-title">
              <span>Querying</span>
            </h5>
            <p class="card-text">Querying multi-model data utilizing a unified interface.</p>
            <p class="fw-bold">Integration in progress.</p>
            <a href="https://www.ksi.mff.cuni.cz/~koupil/mm-quecat/index.html" class="btn btn-secondary">See the stand alone tool</a>
          </div>
        </div>

      </div>
    </article>

  </main>

  <script type="module">

    import { fetchProjects, selectLangString } from "./model.js";

    (async function main() {
      const query = new URLSearchParams(window.location.search);
      const projectIri = query.get("iri");

      if (projectIri === undefined || projectIri === "") {
        renderMissingProject();
        return;
      }

      console.log("Reading project:", projectIri);

      const projects = await fetchProjects((entry) => {
        return entry.iri === projectIri;
      });

      let projectList = projects.map(item => ({
        ...item,
        "label": selectLangString(item.label)
      }));

      if (projectList.length === 0) {
        renderMissingProject();
      } else {
        renderProject(projectList[0]);
      }

    })();

    function renderMissingProject() {
      console.log("Missing project.");
    }

    function renderProject(project) {
      console.log("Rendering project: ", project);
      document.getElementById("project-name").innerText = project.label;
      updateToolLinks(project.iri);
    }

    function updateToolLinks(url) {
      const encodedUrl = encodeURIComponent(url);
      const currentUrl = encodeURIComponent(window.location.href);
      Array.from(document.getElementsByClassName("tool-link")).forEach(link => {
        link.href = link.href
        .replace("$data-specification-iri$", encodedUrl)
        .replace("$return-url$", currentUrl)
        .replace("$project-id$", "5");
      });
    }

  </script>

</body>

</html>
